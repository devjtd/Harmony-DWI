import{a as ee}from"./chunk-LY376Z3Q.js";import{a as F}from"./chunk-XOUSWKTL.js";import{b as R,c as L,d as N,e as A,f as T,g as D,m as Z,o as $,r as V}from"./chunk-XRDTVXG3.js";import{$ as w,B as l,G as y,H as O,Ja as J,K as x,Ka as k,Oa as C,S as c,T as e,Ta as P,U as t,V as d,Xa as K,Ya as Q,Za as X,_a as Y,aa as v,ab as E,ba as m,fa as z,ha as G,ia as n,ja as f,ka as H,n as I,pa as _,q as h,qa as M,r as g,ra as S,s as u}from"./chunk-M6627VFI.js";var W=class o{authService=h(F);userName="";ngOnInit(){let a=this.authService.getUserInfo();a&&(this.userName=a.nombreCompleto||a.email)}logout(){this.authService.logout()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=y({type:o,selectors:[["app-layout"]],decls:23,vars:1,consts:[[1,"sidebar","d-flex","flex-column"],[1,"header-logo-dashboard"],[1,"d-flex","align-items-center","text-decoration-none","text-white"],["src","/logo.png","alt","Logo Harmony","width","40","height","40",1,"me-2"],[1,"h5","mb-0","fw-bold"],[1,"user-info"],[1,"bi","bi-person-circle","me-2"],[1,"nav","flex-column","flex-grow-1"],["routerLink","/profesor/horario","routerLinkActive","active",1,"nav-link-item"],[1,"bi","bi-calendar-check","me-2"],["routerLink","/profesor/contrasena","routerLinkActive","active",1,"nav-link-item"],[1,"bi","bi-key","me-2"],[1,"mt-auto"],[1,"nav-link-item","nav-link-logout",2,"cursor","pointer",3,"click"],[1,"bi","bi-box-arrow-right","me-2"],[1,"main-content"]],template:function(i,r){i&1&&(e(0,"div",0)(1,"div",1)(2,"a",2),d(3,"img",3),e(4,"h1",4),n(5,"Harmony"),t()()(),e(6,"div",5),d(7,"i",6),e(8,"strong"),n(9),t()(),e(10,"nav",7)(11,"a",8),d(12,"i",9),n(13," Horario de Clases "),t(),e(14,"a",10),d(15,"i",11),n(16," Cambiar Contrase\xF1a "),t(),e(17,"div",12)(18,"a",13),v("click",function(){return r.logout()}),d(19,"i",14),n(20," Cerrar Sesi\xF3n "),t()()()(),e(21,"div",15),d(22,"router-outlet"),t()),i&2&&(l(9),f(r.userName))},dependencies:[C,E,K,X,Y],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{background-color:#f8f9fa}.sidebar[_ngcontent-%COMP%]{width:250px;height:100vh;position:fixed;top:0;left:0;padding-top:20px;background-color:#343a40;color:#fff;z-index:1000}.header-logo-dashboard[_ngcontent-%COMP%]{padding:0 20px 20px;border-bottom:1px solid #495057;margin-bottom:15px}.user-info[_ngcontent-%COMP%]{color:#fff;padding:10px 20px;text-align:center;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:10px;font-size:.9rem}.nav-link-item[_ngcontent-%COMP%]{color:#fffc;padding:15px 20px;text-decoration:none;display:block;transition:background-color .2s,color .2s}.nav-link-item[_ngcontent-%COMP%]:hover, .nav-link-item.active[_ngcontent-%COMP%]{background-color:#495057;color:#fff}.nav-link-logout[_ngcontent-%COMP%]{color:#dc3545}.nav-link-logout[_ngcontent-%COMP%]:hover{background-color:#495057;color:#dc3545}.main-content[_ngcontent-%COMP%]{margin-left:250px;padding:20px;min-height:100vh}']})};function re(o,a){o&1&&(e(0,"div",10)(1,"div",11)(2,"span",12),n(3,"Cargando..."),t()(),e(4,"p",13),n(5,"Cargando tus horarios..."),t()())}function ae(o,a){if(o&1&&(e(0,"div",14),d(1,"i",15),n(2),t()),o&2){let i=m();l(2),H(" ",i.errorMessage,`
`)}}function le(o,a){o&1&&(e(0,"div",10)(1,"div",11)(2,"span",12),n(3,"Cargando..."),t()(),e(4,"p",13),n(5,"Cargando tus horarios..."),t()())}function se(o,a){if(o&1&&(e(0,"div",14),d(1,"i",15),n(2),t()),o&2){let i=m();l(2),H(" ",i.errorMessage," ")}}function ce(o,a){o&1&&(e(0,"div",16),d(1,"i",17),n(2," A\xFAn no tienes horarios asignados para esta semana. "),t())}function de(o,a){if(o&1){let i=w();e(0,"tr")(1,"td"),n(2),t(),e(3,"td"),n(4),t(),e(5,"td"),n(6),t(),e(7,"td"),n(8),t(),e(9,"td")(10,"button",23),v("click",function(){let s=g(i).$implicit,p=m(2);return u(p.abrirModalCancelacion(s))}),d(11,"i",24),n(12," Cancelar Clase "),t()()()}if(o&2){let i=a.$implicit,r=m(2);l(2),f(i.taller.nombre),l(2),f(i.diasDeClase),l(2),f(r.formatHora(i.horaInicio)),l(2),f(r.formatHora(i.horaFin))}}function me(o,a){if(o&1&&(e(0,"div",18)(1,"table",19)(2,"thead",20)(3,"tr")(4,"th",21),n(5,"Taller"),t(),e(6,"th",21),n(7,"D\xEDa(s)"),t(),e(8,"th",21),n(9,"Hora Inicio"),t(),e(10,"th",21),n(11,"Hora Fin"),t(),e(12,"th",21),n(13,"Acciones"),t()()(),e(14,"tbody"),x(15,de,13,4,"tr",22),t()()()),o&2){let i=m();l(15),c("ngForOf",i.horarios)}}function pe(o,a){if(o&1){let i=w();e(0,"div",25)(1,"div",26)(2,"div",27)(3,"div",28)(4,"h5",29),n(5,"Cancelar Clase"),t(),e(6,"button",30),v("click",function(){g(i);let s=m();return u(s.cerrarModal())}),t()(),e(7,"div",31)(8,"form")(9,"div",32)(10,"label",33),n(11,"Fecha de la clase a cancelar"),t(),e(12,"input",34),S("ngModelChange",function(s){g(i);let p=m();return M(p.cancelacionData.fecha,s)||(p.cancelacionData.fecha=s),u(s)}),t()(),e(13,"div",32)(14,"label",35),n(15,"Motivo"),t(),e(16,"textarea",36),S("ngModelChange",function(s){g(i);let p=m();return M(p.cancelacionData.motivo,s)||(p.cancelacionData.motivo=s),u(s)}),t()(),e(17,"div",32)(18,"label",37),n(19,"Acci\xF3n a tomar (ej. Reprogramaci\xF3n)"),t(),e(20,"input",38),S("ngModelChange",function(s){g(i);let p=m();return M(p.cancelacionData.accion,s)||(p.cancelacionData.accion=s),u(s)}),t()()()(),e(21,"div",39)(22,"button",40),v("click",function(){g(i);let s=m();return u(s.cerrarModal())}),n(23,"Cerrar"),t(),e(24,"button",41),v("click",function(){g(i);let s=m();return u(s.confirmarCancelacion())}),n(25,"Enviar Aviso"),t()()()()()}if(o&2){let i=m();G("d-block",i.showModal),l(12),_("ngModel",i.cancelacionData.fecha),l(4),_("ngModel",i.cancelacionData.motivo),l(4),_("ngModel",i.cancelacionData.accion)}}var B=class o{authService=h(F);profesorService=h(ee);http=h(P);userName="";horarios=[];isLoading=!0;errorMessage=null;showModal=!1;selectedHorario=null;cancelacionData={fecha:"",motivo:"",accion:""};API_URL="http://localhost:8080/api/profesor/horarios";ngOnInit(){console.log("[HORARIO PROFESOR] Inicializando componente");let a=this.authService.getUserInfo();a&&(this.userName=a.nombreCompleto||a.email),this.cargarHorarios()}cargarHorarios(){console.log("[HORARIO PROFESOR] Cargando horarios del profesor"),this.http.get(this.API_URL).subscribe({next:a=>{console.log("[HORARIO PROFESOR] Horarios cargados:",a.length),this.horarios=a,this.isLoading=!1},error:a=>{console.error("[HORARIO PROFESOR] Error al cargar horarios:",a),this.errorMessage="No se pudieron cargar los horarios. Por favor, intenta m\xE1s tarde.",this.isLoading=!1}})}formatHora(a){return a.substring(0,5)}abrirModalCancelacion(a){this.selectedHorario=a,this.showModal=!0,this.cancelacionData={fecha:"",motivo:"",accion:""}}cerrarModal(){this.showModal=!1,this.selectedHorario=null}confirmarCancelacion(){if(!this.selectedHorario||!this.cancelacionData.fecha||!this.cancelacionData.motivo||!this.cancelacionData.accion){alert("Por favor completa todos los campos");return}this.profesorService.cancelarClase(this.selectedHorario.id,this.cancelacionData).subscribe({next:()=>{alert("Clase cancelada correctamente. Se ha notificado al administrador."),this.cerrarModal()},error:a=>{console.error("Error al cancelar clase:",a),alert("Error al cancelar la clase.")}})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=y({type:o,selectors:[["app-horario"]],decls:15,vars:8,consts:[["class","text-center py-5",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"main-content"],[1,"mb-4","text-harmony-title"],["id","horario",1,"calendar-container"],[1,"h3","mb-4","text-harmony-title"],[1,"lead","text-muted"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","modal fade show","tabindex","-1","style","background-color: rgba(0,0,0,0.5);",3,"d-block",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","text-muted"],["role","alert",1,"alert","alert-danger"],[1,"bi","bi-exclamation-triangle-fill","me-2"],["role","alert",1,"alert","alert-warning"],[1,"bi","bi-info-circle-fill","me-2"],[1,"table-responsive"],[1,"table","table-bordered","table-striped","text-center","align-middle"],[1,"table-dark"],["scope","col"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"bi","bi-calendar-x"],["tabindex","-1",1,"modal","fade","show",2,"background-color","rgba(0,0,0,0.5)"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],["for","fecha",1,"form-label"],["type","date","id","fecha","name","fecha",1,"form-control",3,"ngModelChange","ngModel"],["for","motivo",1,"form-label"],["id","motivo","rows","3","name","motivo",1,"form-control",3,"ngModelChange","ngModel"],["for","accion",1,"form-label"],["type","text","id","accion","name","accion","placeholder","Ej. Se posterga para el siguiente martes",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(i,r){i&1&&(x(0,re,6,0,"div",0)(1,ae,3,1,"div",1),e(2,"div",2)(3,"h1",3),n(4),t(),e(5,"section",4)(6,"h2",5),n(7,"Horarios de Clases Asignadas"),t(),e(8,"p",6),n(9,"Aqu\xED puedes ver el detalle de los horarios de las clases que tienes asignadas para esta semana."),t(),x(10,le,6,0,"div",0)(11,se,3,1,"div",1)(12,ce,3,0,"div",7)(13,me,16,1,"div",8),t(),x(14,pe,26,5,"div",9),t()),i&2&&(c("ngIf",r.isLoading),l(),c("ngIf",r.errorMessage&&!r.isLoading),l(3),H("Bienvenido, Profesor ",r.userName),l(6),c("ngIf",r.isLoading),l(),c("ngIf",r.errorMessage&&!r.isLoading),l(),c("ngIf",!r.isLoading&&!r.errorMessage&&r.horarios.length===0),l(),c("ngIf",!r.isLoading&&!r.errorMessage&&r.horarios.length>0),l(),c("ngIf",r.showModal))},dependencies:[C,J,k,V,D,R,L,N,T,A],styles:['@charset "UTF-8";.calendar-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:20px;box-shadow:0 4px 12px #0000001a}.table-dark[_ngcontent-%COMP%]{--bs-table-bg: #212529;color:#fff}.text-harmony-title[_ngcontent-%COMP%]{color:#5e3ea1!important;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,.1)}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}']})};function ge(o,a){if(o&1&&(e(0,"div",22),d(1,"i",23),e(2,"span"),n(3),t()()),o&2){let i=m();l(3),f(i.successMessage)}}function ue(o,a){if(o&1&&(e(0,"div",24),d(1,"i",25),e(2,"span"),n(3),t()()),o&2){let i=m();l(3),f(i.errorMessage)}}function fe(o,a){o&1&&(e(0,"span"),n(1,"Confirmar Cambio"),t())}function be(o,a){o&1&&(e(0,"span"),d(1,"span",26),n(2," Cambiando... "),t())}var U=class o{http=h(P);router=h(Q);nuevaContrasena="";confirmarContrasena="";successMessage=null;errorMessage=null;isLoading=!1;API_URL="http://localhost:8080/api/profesor/cambiar-clave";ngOnInit(){console.log("[CAMBIO CONTRASE\xD1A PROFESOR] Componente inicializado")}cambiarContrasena(a){if(this.successMessage=null,this.errorMessage=null,a.invalid){this.errorMessage="Por favor, completa todos los campos.";return}if(this.nuevaContrasena!==this.confirmarContrasena){this.errorMessage="Las contrase\xF1as no coinciden.";return}if(this.nuevaContrasena.length<6){this.errorMessage="La contrase\xF1a debe tener al menos 6 caracteres.";return}this.isLoading=!0,console.log("[CAMBIO CONTRASE\xD1A PROFESOR] Enviando solicitud de cambio");let i={nuevaContrasena:this.nuevaContrasena,confirmarContrasena:this.confirmarContrasena};this.http.post(this.API_URL,i,{responseType:"text"}).subscribe({next:()=>{console.log("[CAMBIO CONTRASE\xD1A PROFESOR] Contrase\xF1a cambiada exitosamente"),this.successMessage="\xA1Contrase\xF1a cambiada exitosamente! Ser\xE1s redirigido al login...",this.isLoading=!1,a.resetForm(),setTimeout(()=>{this.router.navigate(["/auth/login"])},3e3)},error:r=>{console.error("[CAMBIO CONTRASE\xD1A PROFESOR] Error:",r);let s=r.error||"Hubo un error al cambiar la contrase\xF1a. Por favor, intenta nuevamente.";this.errorMessage=s,this.isLoading=!1}})}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=y({type:o,selectors:[["app-contrasena"]],decls:34,vars:9,consts:[["passwordForm","ngForm"],[1,"main-content"],[1,"mb-4"],["id","cambio-contrasena",1,"password-container"],[1,"h3","mb-4","text-warning"],["class","alert alert-success","role","alert",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-warning"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"h4","mb-3"],[1,"row","justify-content-center"],[1,"col-lg-8"],[1,"mt-4",3,"ngSubmit"],[1,"mb-3"],["for","nuevaContrasena",1,"form-label","fw-bold"],["type","password","id","nuevaContrasena","name","nuevaContrasena","required","","minlength","6","placeholder","M\xEDnimo 6 caracteres",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"form-text","text-muted"],["for","confirmarContrasena",1,"form-label","fw-bold"],["type","password","id","confirmarContrasena","name","confirmarContrasena","required","","minlength","6","placeholder","Vuelve a escribir la nueva contrase\xF1a",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","btn-lg","btn-confirmar-password",3,"disabled"],[4,"ngIf"],["role","alert",1,"alert","alert-success"],[1,"bi","bi-check-circle-fill","me-2"],["role","alert",1,"alert","alert-danger"],[1,"bi","bi-exclamation-octagon-fill","me-2"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(i,r){if(i&1){let s=w();e(0,"div",1)(1,"h1",2),n(2,"Configuraci\xF3n de Seguridad"),t(),e(3,"section",3)(4,"h2",4),n(5,"\xA1Advertencia de Seguridad!"),t(),x(6,ge,4,1,"div",5)(7,ue,4,1,"div",6),e(8,"div",7),d(9,"i",8),n(10," Recomendamos "),e(11,"strong"),n(12,"encarecidamente"),t(),n(13," que cambies tu contrase\xF1a temporal o inicial inmediatamente para proteger tu cuenta. "),t(),e(14,"h3",9),n(15,"Establecer Nueva Contrase\xF1a"),t(),e(16,"div",10)(17,"div",11)(18,"form",12,0),v("ngSubmit",function(){g(s);let b=z(19);return u(r.cambiarContrasena(b))}),e(20,"div",13)(21,"label",14),n(22,"Nueva Contrase\xF1a"),t(),e(23,"input",15),S("ngModelChange",function(b){return g(s),M(r.nuevaContrasena,b)||(r.nuevaContrasena=b),u(b)}),t(),e(24,"small",16),n(25,"M\xEDnimo 6 caracteres, se recomienda incluir may\xFAsculas y n\xFAmeros"),t()(),e(26,"div",2)(27,"label",17),n(28,"Confirmar Nueva Contrase\xF1a"),t(),e(29,"input",18),S("ngModelChange",function(b){return g(s),M(r.confirmarContrasena,b)||(r.confirmarContrasena=b),u(b)}),t()(),e(30,"div",19)(31,"button",20),x(32,fe,2,0,"span",21)(33,be,3,0,"span",21),t()()()()()()()}if(i&2){let s=z(19);l(6),c("ngIf",r.successMessage),l(),c("ngIf",r.errorMessage),l(16),_("ngModel",r.nuevaContrasena),c("disabled",r.isLoading),l(6),_("ngModel",r.confirmarContrasena),c("disabled",r.isLoading),l(2),c("disabled",s.invalid||r.isLoading),l(),c("ngIf",!r.isLoading),l(),c("ngIf",r.isLoading)}},dependencies:[C,k,V,D,R,L,N,Z,$,T,A],styles:[".password-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:30px;box-shadow:0 4px 12px #0000001a}.password-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:10px 15px;border-radius:6px}.btn-confirmar-password[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;font-weight:700;padding:10px 20px;transition:background-color .3s ease}.btn-confirmar-password[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3;border-color:#0056b3}.btn-confirmar-password[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}"]})};var he=[{path:"",component:W,children:[{path:"",redirectTo:"horario",pathMatch:"full"},{path:"horario",component:B,title:"Harmony - Profesor: Mi Horario"},{path:"contrasena",component:U,title:"Harmony - Profesor: Cambiar Contrase\xF1a"},{path:"**",redirectTo:"horario"}]}],q=class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=O({type:o});static \u0275inj=I({imports:[E.forChild(he),E]})};var ie=class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=O({type:o});static \u0275inj=I({imports:[C,q]})};export{ie as ProfesorModule};
